<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified 4-in-1 Prototype (All Personas)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #e5e7eb; }

        /* SKL Color Palette */
        :root {
            --skl-orange: rgb(245, 131, 60);
            --skl-green: rgb(128, 195, 66);
            --skl-gray: rgb(147, 149, 152);
        }

        /* --- Global Styles --- */
        .bg-skl-orange { background-color: var(--skl-orange); }
        .text-skl-orange { color: var(--skl-orange); }
        .border-skl-orange { border-color: var(--skl-orange); }
        .bg-skl-green { background-color: var(--skl-green); }
        .text-skl-green { color: var(--skl-green); }
        .border-skl-green { border-color: var(--skl-green); }
        .bg-skl-gray { background-color: var(--skl-gray); }
        .text-skl-gray { color: var(--skl-gray); }
        .border-skl-gray { border-color: var(--skl-gray); }

        /* --- Persona Switcher (Collapsible, Top Right) --- */
        #persona-switcher-container {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.75rem;
        }
        #persona-options {
            display: flex; flex-direction: column; gap: 0.5rem;
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform-origin: top right; order: 2;
        }
        #persona-options.hidden {
            opacity: 0; transform: scale(0.95) translateY(-10px);
            pointer-events: none;
        }
        #persona-options button {
            background-color: #374151; color: white; border: none;
            border-radius: 0.5rem; padding: 0.75rem 1rem; font-weight: 600;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); cursor: pointer;
            transition: background-color 0.2s; display: flex; align-items: center;
            gap: 0.5rem; white-space: nowrap;
        }
        #persona-options button:hover { background-color: #4b5563; }
        #persona-options button.active { background-color: var(--skl-orange); }
        #persona-toggle-btn {
            background-color: #1f2937; color: white; border: none;
            width: 60px; height: 60px; border-radius: 50%; font-size: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); cursor: pointer;
            transition: all 0.2s; display: flex; align-items: center;
            justify-content: center; order: 1;
        }
        #persona-toggle-btn:hover { transform: scale(1.1); }

        /* --- Base App Styles (Mobile Personas: Customer, Checker, AD, Zone) --- */
        /* Applied to all app wrappers now */
        .app-container {
            max-width: 420px; height: 95vh; max-height: 900px;
            margin: auto; border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden; display: flex; flex-direction: column;
            background: #f7fafc;
        }
        .app-header {
            color: white; padding: 1.5rem 1.25rem; text-align: center;
            font-size: 1.25rem; font-weight: 600; position: relative;
        }
        .app-header .back-btn {
            position: absolute; left: 1.25rem; top: 50%; transform: translateY(-50%);
            font-size: 1.25rem; cursor: pointer;
        }
        .app-content {
            flex-grow: 1; overflow-y: auto; padding: 1.5rem;
            background-color: #f3f4f6;
        }
        .app-nav {
            display: flex; justify-content: space-around; padding: 0.75rem 0;
            border-top: 1px solid #e2e8f0; background: white;
        }
        .app-nav .nav-item {
            display: flex; flex-direction: column; align-items: center;
            font-size: 0.75rem; color: var(--skl-gray); cursor: pointer;
            flex: 1; text-align: center;
        }
        .app-nav .nav-item.disabled {
            opacity: 0.5; cursor: not-allowed; pointer-events: none;
        }
        .app-nav .nav-item i { font-size: 1.25rem; margin-bottom: 0.25rem; }

        /* Button Base */
        .btn {
            display: block; width: 100%; padding: 0.875rem; border-radius: 0.5rem;
            font-weight: 600; text-align: center; cursor: pointer;
            transition: all 0.2s; color: white;
        }
        .btn-sm { padding: 0.5rem 1rem; font-size: 0.875rem; } /* Small button variant */
        .btn-primary { background-color: var(--skl-green); }
        .btn-secondary { background-color: var(--skl-gray); }
        .btn-danger { background-color: #dc2626; }
        .btn-alert { background-color: var(--skl-orange); }
        .btn-outline {
            border: 2px solid var(--skl-orange); color: var(--skl-orange); background: white;
        }
        .btn:disabled, .btn-disabled {
            background-color: #cbd5e0; cursor: not-allowed; color: #718096;
        }

        /* --- App 1 (Customer) Specific Styles --- */
        #app-customer .app-header { background-color: var(--skl-orange); }
        #app-customer .app-nav .nav-item.active { color: var(--skl-orange); }
        .stepper { display: flex; flex-direction: column; }
        .step { display: flex; align-items: flex-start; position: relative; padding-bottom: 1.5rem; }
        .step:not(:last-child)::before { content: ''; position: absolute; left: 12px; top: 30px; bottom: 0; width: 2px; background: #e2e8f0; }
        .step.completed:not(:last-child)::before { background: var(--skl-green); }
        .step-icon { width: 26px; height: 26px; border-radius: 50%; background: #e2e8f0; display: flex; align-items: center; justify-content: center; font-weight: 600; color: var(--skl-gray); flex-shrink: 0; margin-right: 0.75rem; z-index: 10; }
        .step.completed .step-icon { background: var(--skl-green); color: white; }
        .step.active .step-icon { background: var(--skl-orange); color: white; }
        .step-content { padding-top: 2px; }
        .step-title { font-weight: 600; color: #2d3748; }
        .step-desc { font-size: 0.875rem; color: #718096; }
        .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 0.5rem; text-align: center; }
        .calendar-header { font-weight: 600; color: var(--skl-gray); font-size: 0.875rem; }
        .calendar-day { padding: 0.75rem 0; border-radius: 50%; cursor: pointer; transition: all 0.2s; }
        .calendar-day.today { background: #e0f2fe; color: #0c4a6e; font-weight: bold; border: 2px solid #0284c7; } /* Highlight today more */
        .calendar-day.selected { background: var(--skl-green); color: white; }
        .calendar-day:not(.disabled):hover { background: #e2e8f0; }
        .calendar-day.disabled { color: #cbd5e0; cursor: not-allowed; opacity: 0.6; }
        .calendar-day.full {
            background-color: #ef4444; color: white; opacity: 0.8;
            cursor: pointer; font-weight: 600;
        }
        .calendar-day.full:hover { opacity: 1; }
        .time-slot { padding: 1.25rem; border: 2px solid #e2e8f0; border-radius: 0.5rem; text-align: center; cursor: pointer; transition: all 0.2s; }
        .time-slot.selected { border-color: var(--skl-green); background: #f0fff4; }
        .time-slot.disabled { background: var(--skl-gray); border-color: var(--skl-gray); color: white; cursor: not-allowed; opacity: 0.7; }
        .time-slot i { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .time-slot-title { font-weight: 600; }
        .star-rating { display: flex; justify-content: center; gap: 0.5rem; }
        .star-rating i { font-size: 1.75rem; color: #cbd5e0; cursor: pointer; }
        .star-rating i.selected { color: #facc15; }
        .notification-card {
            background-color: var(--skl-orange); border-left: 4px solid #c2410c;
            color: white; padding: 1rem; border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 1.5rem;
        }
        .modal-overlay {
            position: fixed; inset: 0; background-color: rgba(0,0,0,0.6);
            display: flex; align-items: center; justify-content: center;
            padding: 1rem; z-index: 1050;
        }
        .modal-content {
            background: white; padding: 1.5rem; border-radius: 0.75rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            max-width: 400px; width: 100%; text-align: center;
        }
         .modal-content label { display: block; text-align: left; margin-bottom: 0.25rem; font-weight: 500; font-size: 0.875rem; color: #4b5563;}
         .modal-content input, .modal-content select { width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; margin-bottom: 1rem; }

        /* --- App 2 (Checker) Specific Styles --- */
        #app-checker .app-header { background-color: var(--skl-green); }
        #app-checker .app-nav .nav-item.active { color: var(--skl-green); }
        .job-card { background: white; padding: 1rem; border-radius: 0.5rem; border-left: 5px solid var(--skl-orange); box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 0.75rem; cursor: pointer; }
        .job-card-time { font-size: 0.875rem; font-weight: 600; color: #6b7280; }
        .job-card-customer { font-size: 1.125rem; font-weight: 600; color: #111827; }
        .kpi-time { font-size: 0.8rem; font-weight: 500; color: #dc2626; margin-top: 0.25rem; }
        #app-checker .calendar-day.selected { background: #fee2e2; border: 2px solid #dc2626; }

        /* --- App 3 (AD) Specific Styles --- */
        #app-ad .app-header { background-color: var(--skl-gray); }
        #app-ad .app-nav .nav-item.active { color: var(--skl-green); }
        .customer-card { background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 0.75rem; cursor: pointer; }
        .customer-name { font-size: 1.125rem; font-weight: 600; color: #111827; }
        .customer-status { font-size: 0.875rem; font-weight: 500; }
        .mini-stepper { display: flex; justify-content: space-between; align-items: flex-start; padding: 0.5rem 0; }
        .mini-step { display: flex; flex-direction: column; align-items: center; position: relative; flex-grow: 1; width: 20%; }
        .mini-step:not(:last-child)::after { content: ''; position: absolute; top: 10px; left: 50%; right: -50%; height: 2px; background: #e5e7eb; z-index: 1; }
        .mini-step.completed:not(:last-child)::after { background: var(--skl-green); }
        .mini-step-icon { width: 20px; height: 20px; border-radius: 50%; background: #e5e7eb; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 600; color: #6b7280; z-index: 2; }
        .mini-step.completed .mini-step-icon { background: var(--skl-green); color: white; }
        .mini-step.active .mini-step-icon { background: var(--skl-orange); color: white; }
        .mini-step-label { font-size: 0.65rem; color: #6b7280; margin-top: 0.25rem; text-align: center; width: 60px; }
        .mini-step.active .mini-step-label { color: #111827; font-weight: 600; }

        /* --- App 4 (Admin / Zone - HPLS) Mobile Styles --- */
        #app-admin .app-header { background-color: #1f2937; } /* Dark header */
        #app-admin .app-nav .nav-item.active { color: var(--skl-orange); } /* Orange active */
        /* Table Styles Adjustment for Mobile */
        #app-admin .data-table-container { overflow-x: auto; /* Make table container scrollable */}
        #app-admin .data-table { width: 100%; border-collapse: collapse; min-width: 600px; /* Ensure table has min width for scrolling */}
        #app-admin .data-table th, #app-admin .data-table td { padding: 0.75rem 1rem; border-bottom: 1px solid #e5e7eb; text-align: left; white-space: nowrap; font-size: 0.875rem; /* Slightly smaller font */}
        #app-admin .data-table th { background: #f3f4f6; font-weight: 600; color: #4b5563; }
        #app-admin .data-table tbody tr:hover { background: #f0f9ff; }
         #app-admin .data-table .action-button { background: none; border: none; color: #ef4444; cursor: pointer; padding: 0.25rem; } /* Style for remove button */
         #app-admin .data-table .action-button:hover { color: #b91c1c; }
        /* Urgent Card Adjustment */
        #app-admin .urgent-card { background: #fffbeb; border-left: 5px solid var(--skl-orange); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: flex-start; flex-direction: column; gap: 0.5rem;}
         #app-admin .urgent-card .btn { width: 100%; margin-top: 0.5rem;} /* Full width button */
         #app-admin .urgent-card h3 { font-size: 1.1rem;}
        /* Notification Item Adjustment */
        #app-admin .notification-item { display: flex; align-items: flex-start; gap: 1rem; padding: 1rem; border-bottom: 1px solid #e5e7eb; }
        #app-admin .notification-item:hover { background: #f9fafb; }
        #app-admin .notification-icon { font-size: 1.25rem; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        #app-admin .notification-icon.high { background: #fef2f2; color: #dc2626; }
        #app-admin .notification-icon.medium { background: #fffbeb; color: #d97706; }
        #app-admin .notification-icon.low { background: #f0f9ff; color: #2563eb; }
        #app-admin .notification-content p { color: #111827; font-weight: 500; }
        #app-admin .notification-content .time { font-size: 0.875rem; color: #6b7280; }

    </style>
</head>
<body>

    <!-- ======== MODIFIED: Persona Switcher ======== -->
    <div id="persona-switcher-container">
        <!-- This is the main toggle button -->
        <button id="persona-toggle-btn" onclick="togglePersonaSwitcher()">
            <i class="fas fa-users"></i>
        </button>
        <!-- These options will be hidden by default and appear below the button -->
        <div id="persona-options" class="hidden">
            <button id="btn-view-customer" onclick="showAppView('app-customer')"><i class="fas fa-user"></i> Customer - SKL Mobile</button>
            <button id="btn-view-checker" onclick="showAppView('app-checker')"><i class="fas fa-motorcycle"></i> Checker - Mobility</button>
            <button id="btn-view-ad" onclick="showAppView('app-ad')"><i class="fas fa-user-tie"></i> AD - Smart App</button>
            <button id="btn-view-admin" onclick="showAppView('app-admin')"><i class="fas fa-user-shield"></i> Zone - HPLS</button>
        </div>
    </div>
    <!-- ======== END MODIFIED ======== -->


    <!-- ======== APP 1: CUSTOMER (SKL Mobile App) ======== -->
    <div id="app-customer" class="app-wrapper">
        <div class="app-container">
             <!-- Customer screens here... -->
             <!-- Screen: Dashboard -->
            <div id="screen-dashboard" class="app-screen h-full flex flex-col">
                <div class="app-header">
                    <span>หน้าหลัก</span>
                </div>
                <div class="app-content">
                    <div id="feedback-popup-trigger" class="hidden bg-skl-orange border-l-4 border-orange-700 text-white p-4 rounded-lg shadow mb-6" role="alert">
                        <p class="font-bold">การประเมินเสร็จสิ้น</p>
                        <p>โปรดให้คะแนนการให้บริการของ Checker</p>
                        <button class="btn bg-white !text-skl-orange mt-3" onclick="showScreen_Customer('screen-feedback-form')">ให้คะแนนเลย</button>
                    </div>
                    <div id="appointment-reminder-trigger" class="notification-card flex items-center" role="alert">
                        <i class="fas fa-bell text-2xl text-white mr-4 flex-shrink-0"></i>
                        <div class="flex-grow">
                            <p class="font-bold">แจ้งเตือน: ท่านมีนัดหมายในวันพรุ่งนี้</p>
                            <p class="text-sm">หากไม่สะดวกกรุณาเลื่อนนัดภายใน 23.59 วันนี้</p>
                        </div>
                        <button class="btn btn-outline !w-auto !px-4 !py-2 ml-4 !text-sm flex-shrink-0" onclick="showScreen_Customer('screen-my-appointment')">เลื่อนนัด</button>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow mb-6">
                        <h2 class="text-lg font-semibold text-gray-800 mb-4">สถานะการประเมิน</h2>
                        <div class="stepper">
                            <div class="step"><div class="step-icon">4</div><div class="step-content"><div class="step-title">สถานะ 4: ผลประเมินออกแล้ว</div><div class="step-desc">ติดต่อ AD ของท่าน</div></div></div>
                            <div class="step"><div class="step-icon">3</div><div class="step-content"><div class="step-title">สถานะ 3: กำลังพิจารณาผลประเมิน</div><div class="step-desc">CK เข้าประเมินจบแล้ว</div></div></div>
                            <div class="step active"><div class="step-icon">2</div><div class="step-content"><div class="step-title">สถานะ 2: รอการติดต่อ</div><div class="step-desc">นัดหมายแล้ว รอ CK</div></div></div>
                            <div class="step completed"><div class="step-icon">1</div><div class="step-content"><div class="step-title">สถานะ 1: กรุณานัดหมายเข้าประเมิน</div><div class="step-desc">รอการนัดหมาย</div></div></div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="showScreen_Customer('screen-schedule-calendar')">
                        <i class="fas fa-calendar-alt mr-2"></i> นัดหมายเข้าประเมิน
                    </button>
                </div>
                <nav class="app-nav">
                    <div class="nav-item active" onclick="showScreen_Customer('screen-dashboard')"><i class="fas fa-home"></i>หน้าหลัก</div>
                    <div class="nav-item" onclick="showScreen_Customer('screen-my-appointment')"><i class="fas fa-calendar-check"></i>นัดหมาย</div>
                    <div id="nav-feedback-customer" class="nav-item disabled" onclick="showScreen_Customer('screen-feedback-form')">
                         <i class="fas fa-star"></i>ให้คะแนน
                    </div>
                    <div class="nav-item" onclick="showScreen_Customer('screen-profile')"><i class="fas fa-user"></i>โปรไฟล์</div>
                </nav>
            </div>

            <!-- Screen: Schedule Calendar -->
            <div id="screen-schedule-calendar" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Customer('screen-dashboard')"></i>
                    <span>1. เลือกวันที่นัดหมาย</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold">ตุลาคม 2025</h3></div>
                        <div class="calendar" id="customer-calendar-grid">
                            <!-- Calendar days will be generated by JS -->
                        </div>
                    </div>
                    <button class="btn btn-primary mt-6" onclick="navigateToTimeSelection()">ถัดไป</button>
                </div>
            </div>

            <!-- Screen: Schedule Time -->
            <div id="screen-schedule-time" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Customer('screen-schedule-calendar')"></i>
                    <span>2. เลือกช่วงเวลา</span>
                </div>
                <div class="app-content">
                    <p id="selected-date-text" class="text-skl-gray text-center mb-6">วันที่เลือก: 15 ตุลาคม 2025</p>
                    <div class="grid grid-cols-2 gap-4">
                        <div id="slot-am" class="time-slot" onclick="selectTime(this, 'ช่วงเช้า (9:00 - 12:00 น.)')">
                            <i class="fas fa-sun text-yellow-500"></i>
                            <div class="time-slot-title">ช่วงเช้า</div>
                            <div class="text-sm text-skl-gray">(9:00 - 12:00 น.)</div>
                        </div>
                        <div id="slot-pm" class="time-slot" onclick="selectTime(this, 'ช่วงบ่าย (13:00 - 17:00 น.)')">
                            <i class="fas fa-moon text-blue-800"></i>
                            <div class="time-slot-title">ช่วงบ่าย</div>
                            <div class="text-sm text-skl-gray">(13:00 - 17:00 น.)</div>
                        </div>
                    </div>
                    <div id="urgent-request-container" class="mt-8 text-center hidden">
                        <p class="text-gray-700 mb-4">Slot ที่ท่านเลือกเต็มทั้งหมด</p>
                        <button class="btn btn-outline" onclick="showModal('full-day-warning-modal')">
                            <i class="fas fa-exclamation-circle mr-2"></i> ขอเข้าประเมินด่วน
                        </button>
                    </div>
                    <button class="btn btn-primary mt-6" onclick="showScreen_Customer('screen-schedule-map')">ถัดไป</button>
                </div>
            </div>

            <!-- Screen: Schedule Map -->
            <div id="screen-schedule-map" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Customer('screen-schedule-time')"></i>
                    <span>3. ปักหมุดพิกัด</span>
                </div>
                <div class="app-content space-y-4">
                    <!-- 1. Map Placeholder -->
                    <div class="h-48 bg-gray-300 rounded-lg flex items-center justify-center relative">
                        <img src="https://placehold.co/420x200/e2e8f0/94a3b8?text=Map+Placeholder" alt="Map Placeholder" class="w-full h-full object-cover rounded-lg">
                        <i class="fas fa-map-marker-alt text-red-500 text-4xl absolute" style="top: 50%; left: 50%; transform: translate(-50%, -50%);"></i>
                    </div>
                    <!-- 2. Search Input -->
                    <div class="relative">
                        <input type="text" placeholder="ค้นหาสถานที่..." class="w-full p-3 pl-10 border rounded-lg bg-white">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-skl-gray"></i>
                    </div>
                    <!-- 3. Use Current Location Button -->
                    <button class="btn btn-secondary !bg-white !text-skl-gray border border-skl-gray">
                        <i class="fas fa-crosshairs mr-2"></i> ใช้ตำแหน่งปัจจุบัน
                    </button>
                    <!-- 4. Detailed Address Text Area (Auto-filled) -->
                    <div>
                        <label for="detailed-address" class="text-sm font-medium text-skl-gray">ที่อยู่ (จากข้อมูลกลาง)</label>
                        <textarea id="detailed-address" class="w-full p-3 border rounded-lg mt-1 bg-gray-100" rows="3" placeholder="กำลังโหลดที่อยู่..."></textarea>
                        <p class="text-xs text-skl-gray mt-1">กรุณากดปักหมุดบนแผนที่เพื่อยืนยัน/แก้ไขตำแหน่ง</p>
                    </div>
                     <!-- 5. Next Button -->
                    <button class="btn btn-primary mt-4" onclick="goToSummary()">ถัดไป</button>
                </div>
            </div>

            <!-- Screen: Schedule Summary -->
            <div id="screen-schedule-summary" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Customer('screen-schedule-map')"></i>
                    <span>4. สรุปข้อมูลนัดหมาย</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow space-y-4">
                        <div><label class="text-sm font-medium text-skl-gray">วันที่นัดหมาย</label><p id="summary-date" class="text-lg font-semibold text-gray-800">15 ตุลาคม 2025</p></div>
                        <div><label class="text-sm font-medium text-skl-gray">ช่วงเวลา</label><p id="summary-time" class="text-lg font-semibold text-gray-800">ช่วงเช้า (9:00 - 12:00 น.)</p></div>
                        <div><label class="text-sm font-medium text-skl-gray">ที่อยู่</label><p id="summary-address" class="text-lg font-semibold text-gray-800 whitespace-pre-wrap">ยังไม่ได้กรอก</p></div>
                    </div>
                    <button class="btn btn-primary mt-8" onclick="showScreen_Customer('screen-checklist')">ยืนยัน (Submit) และดูเอกสาร</button>
                </div>
            </div>

            <!-- Screen: Checklist -->
            <div id="screen-checklist" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Customer('screen-dashboard')"></i>
                    <span>Checklist เอกสาร</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow">
                        <h2 class="text-lg font-semibold text-gray-800 mb-4">เอกสารที่ต้องเตรียม (Dynamic)</h2>
                        <div class="mb-4">
                            <label class="text-sm font-medium text-skl-gray">กลุ่มอาชีพของคุณ:</label>
                            <select class="w-full p-3 border rounded-lg mt-1" onchange="updateChecklist(this.value)">
                                <option value="bkk">พนักงานเอกชน</option>
                                <option value="kaset">เกษตรกร</option>
                                <option value="rao">ผู้รับเหมา</option>
                            </select>
                        </div>
                        <div id="checklist-bkk"><ul class="list-disc list-inside space-y-2 text-gray-700"><li>Statement ธนาคาร (6 เดือนล่าสุด)</li><li>สลิปเงินเดือน (3 เดือนล่าสุด)</li></ul></div>
                        <div id="checklist-kaset" class="hidden"><ul class="list-disc list-inside space-y-2 text-gray-700"><li>ทบ.เกษตรกร</li><li>เอกสารที่ดิน</li><li>บิลขายผลผลิต</li></ul></div>
                        <div id="checklist-rao" class="hidden"><ul class="list-disc list-inside space-y-2 text-gray-700"><li>เอกสาร 1</li><li>เอกสาร 2</li></ul></div>
                    </div>
                    <button class="btn btn-primary mt-8" onclick="showScreen_Customer('screen-dashboard')">กลับหน้าหลัก</button>
                </div>
            </div>

            <!-- Screen: My Appointment -->
            <div id="screen-my-appointment" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <span>การนัดหมายของฉัน</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow mb-6">
                        <h2 class="text-lg font-semibold text-gray-800 mb-4">นัดหมายของฉัน</h2>
                        <p class="text-sm text-skl-gray mb-1">สถานะ: <span class="font-medium text-skl-orange">1 วันก่อนวันนัด</span></p>
                        <p class="text-sm text-skl-gray mb-4">นัดหมายวันที่: 25 ต.ค. 2025 (วันนี้: 28 ต.ค. 2025)</p> <!-- Updated today's date here for context -->

                        <button class="btn btn-primary" onclick="showScreen_Customer('screen-schedule-calendar')">เลื่อน Slot (Reschedule)</button>

                        <p class="text-xs text-red-600 mt-2 text-center">** กรุณาเลื่อนนัดภายใน 23.59 วันนี้ **</p>
                    </div>
                </div>
                <nav class="app-nav">
                    <div class="nav-item" onclick="showScreen_Customer('screen-dashboard')"><i class="fas fa-home"></i>หน้าหลัก</div>
                    <div class="nav-item active" onclick="showScreen_Customer('screen-my-appointment')"><i class="fas fa-calendar-check"></i>นัดหมาย</div>
                     <div id="nav-feedback-customer-alt" class="nav-item disabled" onclick="showScreen_Customer('screen-feedback-form')">
                         <i class="fas fa-star"></i>ให้คะแนน
                    </div>
                    <div class="nav-item" onclick="showScreen_Customer('screen-profile')"><i class="fas fa-user"></i>โปรไฟล์</div>
                </nav>
            </div>

            <!-- Screen: Feedback Form -->
            <div id="screen-feedback-form" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Customer('screen-dashboard')"></i>
                    <span>ให้คะแนนการให้บริการ</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow text-center">
                        <div class="space-y-6">
                            <div><label class="font-semibold">1. ความรวดเร็วในการเข้าประเมิน</label><div class="star-rating mt-2" data-rating="0"><i class="far fa-star" onclick="rateStar(this, 1)"></i><i class="far fa-star" onclick="rateStar(this, 2)"></i><i class="far fa-star" onclick="rateStar(this, 3)"></i><i class="far fa-star" onclick="rateStar(this, 4)"></i><i class="far fa-star" onclick="rateStar(this, 5)"></i></div></div>
                            <div><label class="font-semibold">2. ความเข้าใจในการอธิบายรายละเอียด</label><div class="star-rating mt-2" data-rating="0"><i class="far fa-star" onclick="rateStar(this, 1)"></i><i class="far fa-star" onclick="rateStar(this, 2)"></i><i class="far fa-star" onclick="rateStar(this, 3)"></i><i class="far fa-star" onclick="rateStar(this, 4)"></i><i class="far fa-star" onclick="rateStar(this, 5)"></i></div></div>
                            <div><label class="font-semibold">3. ความประทับใจในการให้บริการ</label><div class="star-rating mt-2" data-rating="0"><i class="far fa-star" onclick="rateStar(this, 1)"></i><i class="far fa-star" onclick="rateStar(this, 2)"></i><i class="far fa-star" onclick="rateStar(this, 3)"></i><i class="far fa-star" onclick="rateStar(this, 4)"></i><i class="far fa-star" onclick="rateStar(this, 5)"></i></div></div>
                            <div><label class="font-semibold">4. ความพึงพอใจภาพรวม</label><div class="star-rating mt-2" data-rating="0"><i class="far fa-star" onclick="rateStar(this, 1)"></i><i class="far fa-star" onclick="rateStar(this, 2)"></i><i class="far fa-star" onclick="rateStar(this, 3)"></i><i class="far fa-star" onclick="rateStar(this, 4)"></i><i class="far fa-star" onclick="rateStar(this, 5)"></i></div></div>
                        </div>
                        <button class="btn btn-primary mt-8" onclick="submitFeedback()">ส่งคะแนน</button>
                    </div>
                </div>
            </div>

            <!-- Screen: Profile (Placeholder) -->
            <div id="screen-profile" class="app-screen hidden h-full flex flex-col">
                <div class="app-header"><span>โปรไฟล์</span></div>
                <div class="app-content"><p>หน้าโปรไฟล์</p></div>
                <nav class="app-nav">
                    <div class="nav-item" onclick="showScreen_Customer('screen-dashboard')"><i class="fas fa-home"></i>หน้าหลัก</div>
                    <div class="nav-item" onclick="showScreen_Customer('screen-my-appointment')"><i class="fas fa-calendar-check"></i>นัดหมาย</div>
                     <div id="nav-feedback-customer-alt2" class="nav-item disabled" onclick="showScreen_Customer('screen-feedback-form')">
                         <i class="fas fa-star"></i>ให้คะแนน
                    </div>
                    <div class="nav-item active" onclick="showScreen_Customer('screen-profile')"><i class="fas fa-user"></i>โปรไฟล์</div>
                </nav>
            </div>

        </div> <!-- End App 1 Container -->

        <div id="screen-urgent-popup" class="modal-overlay hidden" onclick="closeModal('screen-urgent-popup', event)">
             <div class="modal-content">
                <h2 class="text-xl font-semibold mb-4">ขอเข้าประเมินด่วน</h2>
                <p class="text-skl-gray mb-4">โปรดเลือกเหตุผลที่ท่านต้องการนัดหมายด่วน</p>
                <select class="w-full p-3 border rounded-lg mb-6">
                    <option>ติดเดินทางต่างประเทศ</option>
                    <option>เหตุผลทางการแพทย์</option>
                    <option>อื่นๆ (โปรดระบุ)</option>
                </select>
                <div class="flex gap-4">
                    <button class="btn btn-secondary flex-1" onclick="hideModal('screen-urgent-popup')">ยกเลิก</button>
                    <button class="btn bg-skl-orange flex-1" onclick="submitUrgentRequest()">ยืนยัน</button>
                </div>
            </div>
        </div>
        <div id="full-day-warning-modal" class="modal-overlay hidden" onclick="closeModal('full-day-warning-modal', event)">
             <div class="modal-content">
                 <i class="fas fa-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                <h2 class="text-xl font-semibold mb-2">วันที่ท่านเลือกเต็มแล้ว</h2>
                <p class="text-skl-gray mb-6">ขออภัย วันที่คุณเลือกมีผู้จองเต็มแล้วครับ</p>
                <div class="space-y-3">
                     <button class="btn bg-skl-orange w-full" onclick="showUrgentRequestFromWarning()">
                         <i class="fas fa-bolt mr-2"></i> ขอยื่นเรื่องประเมินด่วน
                     </button>
                    <button class="btn btn-secondary w-full" onclick="hideModal('full-day-warning-modal')">
                         เลือกวันอื่น
                    </button>
                </div>
            </div>
        </div>

    </div>

    <!-- ======== APP 2: CHECKER (Mobility App) ======== -->
    <div id="app-checker" class="app-wrapper hidden">
        <div class="app-container">
            <!-- Checker screens here... -->
             <!-- Screen: Dashboard - Job List -->
            <div id="screen-dashboard-ck" class="app-screen h-full flex flex-col">
                <div class="app-header">
                    <span><i class="fas fa-list-check mr-2"></i> งานวันนี้ (2 งาน)</span>
                </div>
                <div class="app-content">
                    <div class="job-card" onclick="showScreen_Checker('screen-job-detail')">
                        <div class="job-card-time">09:00 - 12:00 (ช่วงเช้า)</div>
                        <div class="job-card-customer">คุณสมหญิง ใจดี</div>
                        <div class="kpi-time"><i class="fas fa-clock mr-1"></i> KPI: 17:00 (วันนี้)</div>
                    </div>
                    <div class="job-card" onclick="showScreen_Checker('screen-job-detail')">
                        <div class="job-card-time">13:00 - 17:00 (ช่วงบ่าย)</div>
                        <div class="job-card-customer">คุณวิรัช มุ่งมั่น</div>
                        <div class="kpi-time"><i class="fas fa-clock mr-1"></i> KPI: 12:00 (พรุ่งนี้)</div>
                    </div>
                </div>
                <nav class="app-nav">
                    <div class="nav-item active" onclick="showScreen_Checker('screen-dashboard-ck')"><i class="fas fa-list-check"></i>งานวันนี้</div>
                    <div class="nav-item" onclick="showScreen_Checker('screen-manage-slot')"><i class="fas fa-calendar-times"></i>ปิด Slot</div>
                    <div class="nav-item" onclick="showScreen_Checker('screen-update-location')"><i class="fas fa-map-pin"></i>On-Trip</div>
                </nav>
            </div>

            <!-- Screen: Job Detail -->
            <div id="screen-job-detail" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Checker('screen-dashboard-ck')"></i>
                    <span>รายละเอียดงาน</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow space-y-4">
                        <div><label class="text-sm font-medium text-skl-gray">ลูกค้า</label><p class="text-lg font-semibold text-gray-800">คุณสมหญิง ใจดี</p></div>
                        <div><label class="text-sm font-medium text-skl-gray">เวลา</label><p class="text-lg font-semibold text-gray-800">09:00 - 12:00</p></div>
                        <div><label class="text-sm font-medium text-skl-gray">KPI</label><p class="text-lg font-semibold text-red-600">17:00 (วันนี้)</p></div>
                        <button class="btn btn-primary"><i class="fas fa-map-location-dot mr-2"></i>ดูแผนที่เส้นทาง</button>
                    </div>
                    <div class="mt-6 space-y-3">
                        <button class="btn btn-secondary" onclick="showScreen_Checker('screen-record-note')"><i class="fas fa-microphone mr-2"></i>บันทึกข้อมูล (เสียง/ข้อความ)</button>
                        <button class="btn btn-primary !bg-blue-600"><i class="fas fa-check-double mr-2"></i>เตรียมพร้อม (รับงานถัดไป)</button>
                        <button class="btn btn-alert" onclick="showScreen_Checker('screen-transfer-job')"><i class="fas fa-exchange-alt mr-2"></i>โอนงานฉุกเฉิน</button>
                        <button class="btn btn-danger" onclick="finishJob()"><i class="fas fa-flag-checkered mr-2"></i>จบภารกิจ (Finish Job)</button>
                    </div>
                </div>
            </div>

            <!-- Screen: Record Note -->
            <div id="screen-record-note" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Checker('screen-job-detail')"></i>
                    <span>บันทึกข้อมูล</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow">
                        <h3 class="font-semibold mb-3">บันทึกข้อความ</h3>
                        <textarea class="w-full p-3 border rounded-lg mb-4" rows="5" placeholder="พิมพ์บันทึก..."></textarea>
                        <h3 class="font-semibold mb-3 mt-6">บันทึกเสียง</h3>
                        <button class="btn btn-primary"><i class="fas fa-microphone mr-2"></i> เริ่มบันทึกเสียง</button>
                    </div>
                    <button class="btn btn-primary mt-6" onclick="showScreen_Checker('screen-job-detail')">บันทึก</button>
                </div>
            </div>

            <!-- Screen: Transfer Job -->
            <div id="screen-transfer-job" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_Checker('screen-job-detail')"></i>
                    <span>โอนงานฉุกเฉิน</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow">
                        <p class="text-skl-gray mb-4">เลือก CK ที่ต้องการโอนงานให้:</p>
                        <select class="w-full p-3 border rounded-lg mb-6"><option>CK002 - สมศรี</option><option>CK003 - สมศักดิ์</option></select>
                        <button class="btn btn-alert" onclick="showScreen_Checker('screen-dashboard-ck')">ยืนยันการโอนงาน</button>
                    </div>
                </div>
            </div>

            <!-- Screen: Manage Slot -->
            <div id="screen-manage-slot" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <span>จัดการตารางงาน (ปิด Slot)</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow">
                        <p class="text-sm text-skl-gray mb-4">เลือกวันที่ต้องการ "ปิด Slot"</p>
                        <div class="calendar">
                            <div class="calendar-header">อา</div><div class="calendar-header">จ</div><div class="calendar-header">อ</div><div class="calendar-header">พ</div><div class="calendar-header">พฤ</div><div class="calendar-header">ศ</div><div class="calendar-header">ส</div>
                            <div class="calendar-day disabled">...</div><div class="calendar-day disabled">...</div><div class="calendar-day disabled">...</div>
                            <div class="calendar-day" onclick="selectDay_Checker(this)">26</div>
                            <div class="calendar-day" onclick="selectDay_Checker(this)">27</div>
                            <div class="calendar-day today" onclick="selectDay_Checker(this)">28</div>
                            <div class="calendar-day" onclick="selectDay_Checker(this)">29</div>
                            <div class="calendar-day full" onclick="selectDay_Checker(this)">30</div> <!-- Assuming 30th is still full -->
                            <div class="calendar-day" onclick="selectDay_Checker(this)">31</div>
                             <!-- Placeholder for next month start -->
                        </div>
                    </div>
                    <div class="mt-6 bg-white p-5 rounded-lg shadow">
                        <h3 class="font-semibold mb-3">วันที่เลือก: 29 ตุลาคม 2025</h3> <!-- Example selected date -->
                        <div class="flex gap-4">
                            <button class="btn btn-danger flex-1">ปิด (ทั้งวัน)</button>
                            <button class="btn btn-danger flex-1">ปิด (เช้า)</button>
                            <button class="btn btn-danger flex-1">ปิด (บ่าย)</button>
                        </div>
                    </div>
                </div>
                <nav class="app-nav">
                    <div class="nav-item" onclick="showScreen_Checker('screen-dashboard-ck')"><i class="fas fa-list-check"></i>งานวันนี้</div>
                    <div class="nav-item active" onclick="showScreen_Checker('screen-manage-slot')"><i class="fas fa-calendar-times"></i>ปิด Slot</div>
                    <div class="nav-item" onclick="showScreen_Checker('screen-update-location')"><i class="fas fa-map-pin"></i>On-Trip</div>
                </nav>
            </div>

            <!-- Screen: Update On-Trip Location -->
            <div id="screen-update-location" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <span>V2: อัปเดตตำแหน่งที่พัก</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow">
                        <p class="text-skl-gray mb-4">อัปเดตตำแหน่งที่พัก (On-Trip) เพื่อใช้เป็นจุดเริ่มต้นคำนวณงานวันถัดไป</p>
                        <div class="h-48 bg-gray-300 rounded-lg flex items-center justify-center mb-4">
                            <img src="https://placehold.co/300x150/e2e8f0/94a3b8?text=Map+Placeholder" alt="Map" class="rounded-lg">
                        </div>
                        <button class="btn btn-primary"><i class="fas fa-map-marker-alt mr-2"></i>ปักหมุดตำแหน่งที่พัก</button>
                    </div>
                </div>
                <nav class="app-nav">
                    <div class="nav-item" onclick="showScreen_Checker('screen-dashboard-ck')"><i class="fas fa-list-check"></i>งานวันนี้</div>
                    <div class="nav-item" onclick="showScreen_Checker('screen-manage-slot')"><i class="fas fa-calendar-times"></i>ปิด Slot</div>
                    <div class="nav-item active" onclick="showScreen_Checker('screen-update-location')"><i class="fas fa-map-pin"></i>On-Trip</div>
                </nav>
            </div>
        </div> <!-- End App 2 Container -->
    </div>

    <!-- ======== APP 3: AD (Smart Application) ======== -->
    <div id="app-ad" class="app-wrapper hidden">
        <div class="app-container">
            <!-- AD screens here... -->
             <!-- Screen: Dashboard - Customer List -->
            <div id="screen-dashboard-ad" class="app-screen h-full flex flex-col">
                <div class="app-header">
                    <span><i class="fas fa-users mr-2"></i>ติดตามสถานะลูกค้า</span>
                </div>
                <div class="app-content">
                    <div class="mb-4">
                        <select class="w-full p-3 border rounded-lg bg-white"><option>กรองสถานะ: รอการนัดหมาย (AD Action)</option></select>
                    </div>
                    <div class="space-y-3">
                        <div class="customer-card border-l-4 border-red-500" onclick="showScreen_AD('screen-customer-detail-ad')">
                            <div class="customer-name">คุณธนาวุฒิ (รอ Action)</div>
                            <div class="customer-status text-red-600 font-bold">สถานะ 1: รอการนัดหมาย</div>
                        </div>
                        <div class="customer-card border-l-4 border-blue-500" onclick="showScreen_AD('screen-customer-detail-ad')">
                            <div class="customer-name">คุณสมหญิง ใจดี</div>
                            <div class="customer-status text-blue-600 font-bold">สถานะ 2: รอเข้าประเมิน</div>
                        </div>
                        <div class="customer-card border-l-4 border-skl-green" onclick="showScreen_AD('screen-customer-detail-ad')">
                            <div class="customer-name">คุณวิรัช มุ่งมั่น</div>
                            <div class="customer-status text-skl-green font-bold">สถานะ 5: ผลประเมิน (Y)</div>
                        </div>
                    </div>
                </div>
                <nav class="app-nav">
                    <div class="nav-item active" onclick="showScreen_AD('screen-dashboard-ad')"><i class="fas fa-users"></i>ลูกค้า</div>
                    <div class="nav-item" onclick="showScreen_AD('screen-schedule-fallback')"><i class="fas fa-calendar-plus"></i>นัดหมายแทน</div>
                </nav>
            </div>

            <!-- Screen: Customer Detail (AD) -->
            <div id="screen-customer-detail-ad" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_AD('screen-dashboard-ad')"></i>
                    <span>สถานะ: คุณธนาวุฒิ</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">สถานะ 5 ขั้นตอน (AD View)</h3>
                        <div class="mini-stepper mt-2">
                            <div class="mini-step active"><div class="mini-step-icon">1</div><div class="mini-step-label">รอการนัดหมาย</div></div>
                            <div class="mini-step"><div class="mini-step-icon">2</div><div class="mini-step-label">รอเข้าประเมิน</div></div>
                            <div class="mini-step"><div class="mini-step-icon">3</div><div class="mini-step-label">เข้าประเมินแล้ว</div></div>
                            <div class="mini-step"><div class="mini-step-icon">4</div><div class="mini-step-label">รอผลประเมิน</div></div>
                            <div class="mini-step"><div class="mini-step-icon">5</div><div class="mini-step-label">ผล (Y/N/W)</div></div>
                        </div>
                    </div>
                    <div class="mt-6 bg-white p-5 rounded-lg shadow">
                        <button class="btn btn-primary" onclick="showScreen_AD('screen-schedule-fallback')">
                            <i class="fas fa-calendar-plus mr-2"></i> นัดหมายแทนลูกค้า
                        </button>
                    </div>
                </div>
            </div>

            <!-- Screen: Manual Scheduling (Fallback Flow) -->
            <div id="screen-schedule-fallback" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_AD('screen-dashboard-ad')"></i>
                    <span>นัดหมายแทนลูกค้า</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow space-y-4">
                        <h3 class="text-lg font-semibold text-gray-800">1. กรอกข้อมูลนัดหมาย</h3>
                        <div><label class="text-sm font-medium text-skl-gray">ชื่อลูกค้า</label><input type="text" value="คุณธนาวุฒิ" class="w-full p-3 border rounded-lg mt-1"></div>
                        <div><label class="text-sm font-medium text-skl-gray">เลือกวันนัดหมาย</label><input type="date" class="w-full p-3 border rounded-lg mt-1"></div>
                        <div><label class="text-sm font-medium text-skl-gray">เลือกช่วงเวลา</label><select class="w-full p-3 border rounded-lg mt-1 bg-white"><option>ช่วงเช้า (AM)</option><option>ช่วงบ่าย (PM)</option></select></div>
                        <button class="btn btn-primary mt-4" onclick="showScreen_AD('screen-schedule-fallback-reason')">
                            ถัดไป (ระบุเหตุผล)
                        </button>
                    </div>
                </div>
            </div>

            <!-- Screen: Manual Scheduling REASON (Fallback Flow) -->
            <div id="screen-schedule-fallback-reason" class="app-screen hidden h-full flex flex-col">
                <div class="app-header">
                    <i class="back-btn fas fa-arrow-left" onclick="showScreen_AD('screen-schedule-fallback')"></i>
                    <span>นัดหมายแทน: ระบุเหตุผล</span>
                </div>
                <div class="app-content">
                    <div class="bg-white p-5 rounded-lg shadow space-y-4">
                        <h3 class="text-lg font-semibold text-gray-800">2. ระบุเหตุผลที่นัดหมายแทน</h3>
                        <p class="text-sm text-red-600">**สำคัญ: โปรดระบุเหตุผลที่ลูกค้าไม่สามารถนัดหมายผ่าน SKL App ได้เอง</S></p>
                        <select class="w-full p-3 border rounded-lg mt-1 bg-white">
                            <option>มือถือไม่รองรับ</option>
                            <option>ลูกค้าไม่มี Smartphone</option>
                            <option>อื่นๆ</option>
                        </select>
                        <button class="btn btn-primary mt-4" onclick="showScreen_AD('screen-dashboard-ad')">
                            <i class="fas fa-check mr-2"></i> ยืนยันการนัดหมาย
                        </button>
                    </div>
                </div>
            </div>
        </div> <!-- End App 3 Container -->
    </div>

    <!-- ======== APP 4: ADMIN / ZONE (HPLS Panel) ======== -->
    <div id="app-admin" class="app-wrapper hidden">
         <div class="app-container"> <!-- Use mobile container structure -->

             <!-- Screens are now direct children -->
             <div id="screen-dashboard-urgent" class="app-screen h-full flex flex-col">
                 <header class="app-header">Queue เคสด่วน (2)</header>
                 <div class="app-content">
                     <p class="text-skl-gray text-sm mb-4">รายการเคส "ประเมินด่วน" ที่ Slot CK ปกติเต็ม</p>
                     <!-- **** MODIFIED: Added ID to list **** -->
                     <div id="urgent-queue-list" class="space-y-4">
                         <div class="urgent-card shadow-sm" data-customer-name="คุณอารี ยา">
                             <div>
                                 <h3 class="font-semibold text-lg">คุณอารี ยา</h3>
                                 <p class="text-gray-700 text-sm">เหตุผล: <span class="font-medium">ติดเดินทางต่างประเทศ</span></p>
                             </div>
                              <!-- **** MODIFIED: Added onclick to open assign modal **** -->
                             <div><button class="btn btn-primary btn-sm" onclick="openAssignModal(this)"><i class="fas fa-share-square mr-1"></i> จ่ายงาน</button></div>
                         </div>
                         <div class="urgent-card shadow-sm" data-customer-name="คุณมานะ ดีต่อ">
                             <div>
                                 <h3 class="font-semibold text-lg">คุณมานะ ดีต่อ</h3>
                                 <p class="text-gray-700 text-sm">เหตุผล: <span class="font-medium">อื่นๆ (รีบใช้)</span></p>
                             </div>
                             <div><button class="btn btn-primary btn-sm" onclick="openAssignModal(this)"><i class="fas fa-share-square mr-1"></i> จ่ายงาน</button></div>
                         </div>
                     </div>
                      <!-- **** END MODIFIED **** -->
                 </div>
                 <!-- Mobile Bottom Nav is added below -->
             </div>

             <div id="screen-notifications" class="app-screen hidden h-full flex flex-col">
                 <header class="app-header">Notification</header>
                 <div class="app-content !p-0"> <!-- Remove padding for list items -->
                     <div class="notification-list">
                         <div class="notification-item">
                             <div class="notification-icon high"><i class="fas fa-exchange-alt"></i></div>
                             <div class="notification-content">
                                 <p>CK001 (สมชาย) ร้องขอ "โอนงานฉุกเฉิน"</p>
                                 <span class="time">2 นาทีที่แล้ว</span>
                             </div>
                         </div>
                         <div class="notification-item">
                             <div class="notification-icon medium"><i class="fas fa-exclamation-circle"></i></div>
                             <div class="notification-content">
                                 <p>เคสด่วน (คุณอารี) ค้างใน Queue นานกว่า 1 ชั่วโมง</p>
                                 <span class="time">10 นาทีที่แล้ว</span>
                             </div>
                         </div>
                         <div class="notification-item">
                             <div class="notification-icon low"><i class="fas fa-calendar-times"></i></div>
                             <div class="notification-content">
                                 <p>CK002 (สมหญิง) "ปิด Slot" วันที่ 28 ต.ค. (ลาพักร้อน)</p>
                                 <span class="time">1 ชั่วโมงที่แล้ว</span>
                             </div>
                         </div>
                     </div>
                 </div>
                 <!-- Mobile Bottom Nav is added below -->
             </div>

             <div id="screen-team-manage" class="app-screen hidden h-full flex flex-col">
                 <header class="app-header">จัดการทีม CK</header>
                 <div class="app-content">
                     <p class="text-skl-gray text-sm mb-4">เพิ่ม/ลบ CK ออกจาก Pool</p>
                      <!-- **** MODIFIED: Added onclick to open add modal **** -->
                     <div class="flex justify-end mb-4"><button class="btn btn-primary btn-sm !w-auto" onclick="showModal('add-checker-modal')"><i class="fas fa-user-plus mr-1"></i> Add CK</button></div>
                      <!-- **** END MODIFIED **** -->
                     <div class="data-table-container bg-white rounded-lg shadow overflow-hidden">
                         <table class="data-table">
                             <thead><tr><th>รหัส</th><th>ชื่อ</th><th>สถานะ</th><th>Action</th></tr></thead>
                              <!-- **** MODIFIED: Added tbody ID and remove button onclick **** -->
                             <tbody id="team-table-body">
                                 <tr>
                                     <td>CK001</td><td>สมชาย มุ่งมั่น</td><td><span class="text-skl-green font-medium">Active</span></td>
                                     <td><button class="action-button" onclick="removeChecker(this)"><i class="fas fa-trash-alt"></i></button></td>
                                 </tr>
                                 <tr>
                                     <td>CK002</td><td>สมหญิง ใจดี</td><td><span class="text-skl-green font-medium">Active</span></td>
                                     <td><button class="action-button" onclick="removeChecker(this)"><i class="fas fa-trash-alt"></i></button></td>
                                 </tr>
                             </tbody>
                              <!-- **** END MODIFIED **** -->
                         </table>
                     </div>
                 </div>
                 <!-- Mobile Bottom Nav is added below -->
             </div>

             <div id="screen-monitor-pool" class="app-screen hidden h-full flex flex-col">
                 <header class="app-header">Monitor Pool</header>
                 <div class="app-content">
                     <p class="text-skl-gray text-sm mb-4">งานทั้งหมดที่รอการจ่ายงาน</p>
                     <div class="data-table-container bg-white rounded-lg shadow overflow-hidden">
                         <table class="data-table">
                             <thead><tr><th>วันที่นัด</th><th>เวลา</th><th>ลูกค้า</th><th>สถานะ</th></tr></thead>
                             <tbody>
                                 <tr><td>29 ต.ค. 2568</td><td>ช่วงเช้า</td><td>คุณมานพ พัฒนา</td><td><span class="text-blue-600 font-medium">รอจ่ายงาน</span></td></tr>
                                 <tr><td>29 ต.ค. 2568</td><td>ช่วงบ่าย</td><td>คุณอารี ใจดี</td><td><span class="text-blue-600 font-medium">รอจ่ายงาน</span></td></tr>
                                 <tr><td>31 ต.ค. 2568</td><td>ช่วงเช้า</td><td>คุณสมศักดิ์ ขยัน</td><td><span class="text-blue-600 font-medium">รอจ่ายงาน</span></td></tr>
                             </tbody>
                         </table>
                     </div>
                 </div>
                 <!-- Mobile Bottom Nav is added below -->
             </div>

             <!-- Mobile Bottom Navigation for Zone -->
             <nav class="app-nav">
                 <div class="nav-item active" onclick="showScreen_Admin('screen-dashboard-urgent')"><i class="fas fa-exclamation-triangle"></i>Queue</div>
                 <div class="nav-item" onclick="showScreen_Admin('screen-notifications')"><i class="fas fa-bell"></i>Notify</div>
                 <div class="nav-item" onclick="showScreen_Admin('screen-team-manage')"><i class="fas fa-users-cog"></i>Team</div>
                 <div class="nav-item" onclick="showScreen_Admin('screen-monitor-pool')"><i class="fas fa-chart-bar"></i>Pool</div>
             </nav>

         </div> <!-- End App 4 Container -->
    </div> <!-- End App 4 Wrapper -->

    <!-- **** ADDED: Modals for Zone Interaction **** -->
    <!-- Assign Job Modal -->
    <div id="assign-job-modal" class="modal-overlay hidden" onclick="closeModal('assign-job-modal', event)">
         <div class="modal-content">
             <h2 class="text-xl font-semibold mb-4">จ่ายงานด่วน</h2>
             <p id="assign-customer-name" class="text-skl-gray mb-4">ลูกค้า: คุณอารี ยา</p>
             <label for="assign-checker-select">เลือก Checker ที่จะมอบหมาย:</label>
             <select id="assign-checker-select">
                 <option value="CK001">CK001 - สมชาย มุ่งมั่น</option>
                 <option value="CK002">CK002 - สมหญิง ใจดี</option>
                 <option value="CK003">CK003 - สมศักดิ์ (เพิ่มใหม่)</option> <!-- Example -->
             </select>
             <div class="flex gap-4 mt-2">
                 <button class="btn btn-secondary flex-1" onclick="hideModal('assign-job-modal')">ยกเลิก</button>
                 <button class="btn btn-primary flex-1" onclick="confirmAssignment()">ยืนยัน</button>
             </div>
         </div>
     </div>

     <!-- Add Checker Modal -->
     <div id="add-checker-modal" class="modal-overlay hidden" onclick="closeModal('add-checker-modal', event)">
         <div class="modal-content">
             <h2 class="text-xl font-semibold mb-4">เพิ่ม Checker ใหม่</h2>
             <label for="new-checker-id">รหัสพนักงาน:</label>
             <input type="text" id="new-checker-id" placeholder="เช่น CK003">
             <label for="new-checker-name">ชื่อ - สกุล:</label>
             <input type="text" id="new-checker-name" placeholder="เช่น สมศักดิ์ ขยันจริง">
             <div class="flex gap-4 mt-2">
                 <button class="btn btn-secondary flex-1" onclick="hideModal('add-checker-modal')">ยกเลิก</button>
                 <button class="btn btn-primary flex-1" onclick="addChecker()">เพิ่ม</button>
             </div>
         </div>
     </div>
     <!-- **** END ADDED **** -->


    <script>
        // --- Modal Helper Functions ---
        function showModal(modalId) {
             const modal = document.getElementById(modalId);
             if (modal) modal.classList.remove('hidden');
        }
        function hideModal(modalId) {
             const modal = document.getElementById(modalId);
             if (modal) modal.classList.add('hidden');
        }
         function closeModal(modalId, event) {
             const modal = document.getElementById(modalId);
             if (modal && event.target === modal) { hideModal(modalId); }
         }

        // --- Persona Switcher Logic ---
        let isPersonaSwitcherOpen = false;
        function togglePersonaSwitcher() {
            const options = document.getElementById('persona-options');
            const toggleBtn = document.getElementById('persona-toggle-btn');
            isPersonaSwitcherOpen = !isPersonaSwitcherOpen;
            if (options && toggleBtn) {
                if (isPersonaSwitcherOpen) {
                    options.classList.remove('hidden');
                    toggleBtn.innerHTML = '<i class="fas fa-times"></i>';
                } else {
                    options.classList.add('hidden');
                    toggleBtn.innerHTML = '<i class="fas fa-users"></i>';
                }
            }
        }
        function showAppView(appId) {
            document.querySelectorAll('.app-wrapper').forEach(el => el.classList.add('hidden'));
            const targetApp = document.getElementById(appId);
             if (targetApp) { targetApp.classList.remove('hidden'); }
             else {
                 console.error("Target app wrapper not found:", appId);
                 document.getElementById('app-customer').classList.remove('hidden'); appId = 'app-customer';
             }
            document.querySelectorAll('#persona-options button').forEach(btn => btn.classList.remove('active'));
             const activeButton = document.getElementById('btn-view-' + appId.split('-')[1]);
             if (activeButton) activeButton.classList.add('active');
            isPersonaSwitcherOpen = false;
             const optionsDiv = document.getElementById('persona-options');
             const toggleBtn = document.getElementById('persona-toggle-btn');
             if (optionsDiv) optionsDiv.classList.add('hidden');
             if (toggleBtn) toggleBtn.innerHTML = '<i class="fas fa-users"></i>';
             // If switching to Admin, ensure the default screen is shown
             if (appId === 'app-admin') { showScreen_Admin(currentScreen_Admin || 'screen-dashboard-urgent'); }
        }

        // --- App 1 (Customer) Logic ---
        let currentScreen_Customer = 'screen-dashboard';
        let selectedDate = null;
        let selectedTimeSlot = null;
        let detailedAddress = "";
        const today = new Date(2025, 9, 28, 10, 0, 0); // Oct 28, 2025, 10:00 AM
        const centralCustomerAddress = "123 หมู่บ้านตัวอย่าง ถ. สุขุมวิท แขวงคลองเตย เขตคลองเตย กรุงเทพมหานคร 10110";

        function showScreen_Customer(screenId) {
             document.querySelectorAll('#app-customer .app-nav .nav-item').forEach(item => item.classList.remove('active'));
             document.querySelectorAll('#app-customer .app-screen').forEach(el => el.classList.add('hidden'));
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                 targetScreen.classList.remove('hidden'); currentScreen_Customer = screenId;
                 const activeNavItems = document.querySelectorAll(`#app-customer .app-nav .nav-item[onclick*="'${screenId}'"]`);
                 activeNavItems.forEach(navItem => { if (navItem) navItem.classList.add('active'); });
            } else {
                 console.error("Customer screen not found:", screenId);
                 document.getElementById('screen-dashboard').classList.remove('hidden'); currentScreen_Customer = 'screen-dashboard';
                 const homeNav = document.querySelector('#app-customer .app-nav .nav-item[onclick*="screen-dashboard"]');
                 if(homeNav) homeNav.classList.add('active'); return;
            }
            if (screenId === 'screen-schedule-map') {
                const addressInput = document.getElementById('detailed-address');
                if (addressInput) { addressInput.value = centralCustomerAddress; }
            }
            if (screenId === 'screen-schedule-time') {
                const slotAm = document.getElementById('slot-am'); const slotPm = document.getElementById('slot-pm');
                if (slotAm) slotAm.classList.remove('disabled', 'selected'); if (slotPm) slotPm.classList.remove('disabled', 'selected');
                if (selectedDate && selectedDate.toDateString() === today.toDateString()) {
                    if (slotAm) slotAm.classList.add('disabled'); // Disable AM slot for Oct 28
                }
            }
            if (screenId === 'screen-schedule-summary') {
                 const summaryDateEl = document.getElementById('summary-date'); const summaryTimeEl = document.getElementById('summary-time'); const summaryAddressEl = document.getElementById('summary-address');
                if (selectedDate && summaryDateEl) { summaryDateEl.innerText = selectedDate.toLocaleDateString('th-TH', { dateStyle: 'long' }); }
                if (selectedTimeSlot && summaryTimeEl) { summaryTimeEl.innerText = selectedTimeSlot; } else if (summaryTimeEl) { summaryTimeEl.innerText = "ยังไม่ได้เลือกเวลา"; }
                 if (summaryAddressEl) { summaryAddressEl.innerText = detailedAddress || "ยังไม่ได้กรอก"; }
            }
        }
        function navigateToTimeSelection() {
            if (selectedDate) { showScreen_Customer('screen-schedule-time'); }
            else {
                console.warn('กรุณาเลือกวันที่ที่ว่างก่อนครับ');
                const calendarElement = document.getElementById('customer-calendar-grid');
                if(calendarElement){ let errorMsg = calendarElement.parentElement.querySelector('.error-message'); if (!errorMsg) { errorMsg = document.createElement('p'); errorMsg.className = 'error-message text-red-600 text-center mt-2'; calendarElement.parentElement.insertAdjacentElement('afterend', errorMsg); } errorMsg.innerText = 'กรุณาเลือกวันที่ที่ว่างก่อนครับ'; }
            }
        }
        function selectDate(element) {
            if (!element || element.classList.contains('disabled') || element.classList.contains('full')) { return; }
            document.querySelectorAll('#app-customer .calendar-day.selected').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected'); const day = parseInt(element.innerText);
            if (!isNaN(day)) {
                 selectedDate = new Date(2025, 9, day); const selectedDateTextEl = document.getElementById('selected-date-text');
                 if (selectedDateTextEl) { selectedDateTextEl.innerText = `วันที่เลือก: ${selectedDate.toLocaleDateString('th-TH', { day: 'numeric', month: 'long', year: 'numeric' })}`; }
                 const calendarElement = document.getElementById('customer-calendar-grid'); if(calendarElement){ const errorMsg = calendarElement.parentElement.querySelector('.error-message'); if(errorMsg) errorMsg.innerText = ''; }
            } else { console.error("Invalid day selected:", element); selectedDate = null; }
        }
        function selectTime(element, timeString) {
            if (!element || element.classList.contains('disabled')) { return; }
            document.querySelectorAll('#app-customer .time-slot').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected'); selectedTimeSlot = timeString;
        }
        function handleFullDayClick() { showModal('full-day-warning-modal'); selectedDate = null; document.querySelectorAll('#app-customer .calendar-day.selected').forEach(el => el.classList.remove('selected')); }
        function showUrgentRequestFromWarning() { hideModal('full-day-warning-modal'); showModal('screen-urgent-popup'); }
        function generateCalendar(year, month) {
            const calendarGrid = document.getElementById('customer-calendar-grid'); if (!calendarGrid) { console.error("Calendar grid not found"); return; } calendarGrid.innerHTML = '';
            const headers = ['อา', 'จ', 'อ', 'พ', 'พฤ', 'ศ', 'ส']; headers.forEach(h => { const el = document.createElement('div'); el.className = 'calendar-header'; el.innerText = h; calendarGrid.appendChild(el); });
            const firstDayOfMonth = new Date(year, month, 1).getDay(); const daysInMonth = new Date(year, month + 1, 0).getDate();
            for (let i = 0; i < firstDayOfMonth; i++) { const el = document.createElement('div'); el.className = 'calendar-day disabled'; calendarGrid.appendChild(el); }
            const todayDateOnly = new Date(today.getFullYear(), today.getMonth(), today.getDate());
            for (let day = 1; day <= daysInMonth; day++) {
                const dayEl = document.createElement('div'); dayEl.innerText = day; const currentDate = new Date(year, month, day); const dayOfWeek = currentDate.getDay(); let classes = ['calendar-day']; let onclickFunc = () => selectDate(dayEl);
                if (currentDate < todayDateOnly || dayOfWeek === 0) { classes.push('disabled'); onclickFunc = null; }
                else if (currentDate.getTime() === todayDateOnly.getTime()) { classes.push('today'); }
                else if (day === 30) { classes.push('full'); onclickFunc = handleFullDayClick; }
                dayEl.className = classes.join(' '); if (onclickFunc) { dayEl.onclick = onclickFunc; } calendarGrid.appendChild(dayEl);
            }
        }
        function rateStar(element, rating) { if (!element || !element.parentElement) return; const parent = element.parentElement; const stars = parent.querySelectorAll('i'); stars.forEach((star, index) => { if (star) { star.className = index < rating ? 'fas fa-star selected' : 'far fa-star'; } }); parent.dataset.rating = rating; }
        function submitUrgentRequest() { hideModal('screen-urgent-popup'); showScreen_Customer('screen-dashboard'); const fb = document.getElementById('feedback-popup-trigger'); if(fb){ fb.innerHTML = "<p class='font-bold'>ส่งคำขอประเมินด่วนสำเร็จ</p><p>หน.โซนจะติดต่อกลับ</p>"; fb.className = "bg-blue-500 border-l-4 border-blue-700 text-white p-4 rounded-lg shadow mb-6"; fb.classList.remove('hidden'); } }
        function submitFeedback() { showScreen_Customer('screen-dashboard'); const fb = document.getElementById('feedback-popup-trigger'); if(fb){ fb.innerHTML = "<p class='font-bold'>ขอบคุณสำหรับคะแนน</p>"; fb.className = "bg-skl-green border-l-4 border-green-700 text-white p-4 rounded-lg shadow mb-6"; fb.classList.remove('hidden'); } disableFeedbackNav(); }
        function updateChecklist(value) { const hide = (id) => { const el = document.getElementById(id); if (el) el.classList.add('hidden'); }; const show = (id) => { const el = document.getElementById(id); if (el) el.classList.remove('hidden'); }; hide('checklist-bkk'); hide('checklist-kaset'); hide('checklist-rao'); show('checklist-' + value); }
        function goToSummary() { const addr = document.getElementById('detailed-address'); if (addr) { detailedAddress = addr.value.trim(); if (!detailedAddress) { console.warn('กรุณากรอกหรือยืนยันที่อยู่'); addr.focus(); let err = addr.parentElement.querySelector('.error-message'); if (!err) { err = document.createElement('p'); err.className = 'error-message text-red-600 text-sm mt-1'; addr.insertAdjacentElement('afterend', err); } err.innerText = 'กรุณากรอกหรือยืนยันที่อยู่'; return; } let err = addr.parentElement.querySelector('.error-message'); if (err) err.innerText = ''; showScreen_Customer('screen-schedule-summary'); } else { console.error("Address input not found"); } }
        function enableFeedbackNav() { document.querySelectorAll('#nav-feedback-customer, #nav-feedback-customer-alt, #nav-feedback-customer-alt2').forEach(item => { if (item) item.classList.remove('disabled'); }); }
        function disableFeedbackNav() { document.querySelectorAll('#nav-feedback-customer, #nav-feedback-customer-alt, #nav-feedback-customer-alt2').forEach(item => { if (item) item.classList.add('disabled'); }); }

        // --- App 2 (Checker) Logic ---
        let currentScreen_Checker = 'screen-dashboard-ck';
        function showScreen_Checker(screenId) { document.querySelectorAll('#app-checker .app-screen').forEach(el => el.classList.add('hidden')); const scr = document.getElementById(screenId); if (scr) { scr.classList.remove('hidden'); currentScreen_Checker = screenId; } else { console.error("Checker screen not found:", screenId); document.getElementById('screen-dashboard-ck').classList.remove('hidden'); currentScreen_Checker = 'screen-dashboard-ck'; } }
        function selectDay_Checker(element) { if (!element) return; document.querySelectorAll('#app-checker .calendar-day.selected').forEach(el => el.classList.remove('selected')); element.classList.add('selected'); }
        function finishJob() { console.log('Simulating "Finish Job"'); showScreen_Checker('screen-dashboard-ck'); const fb = document.getElementById('feedback-popup-trigger'); if (fb) fb.classList.remove('hidden'); enableFeedbackNav(); }

        // --- App 3 (AD) Logic ---
        let currentScreen_AD = 'screen-dashboard-ad';
        function showScreen_AD(screenId) { document.querySelectorAll('#app-ad .app-screen').forEach(el => el.classList.add('hidden')); const scr = document.getElementById(screenId); if(scr){ scr.classList.remove('hidden'); currentScreen_AD = screenId; } else { console.error("AD screen not found:", screenId); document.getElementById('screen-dashboard-ad').classList.remove('hidden'); currentScreen_AD = 'screen-dashboard-ad'; } }

        // --- App 4 (Admin / Zone) Logic ---
        let currentScreen_Admin = 'screen-dashboard-urgent'; // Default screen
         let jobToAssignElement = null; // Store the element of the job being assigned

        function showScreen_Admin(screenId) {
             document.querySelectorAll('#app-admin .app-screen').forEach(el => el.classList.add('hidden'));
             const targetScreen = document.getElementById(screenId);
             if(targetScreen){
                 targetScreen.classList.remove('hidden'); currentScreen_Admin = screenId;
                 document.querySelectorAll('#app-admin .app-nav .nav-item').forEach(link => link.classList.remove('active'));
                 const activeLinks = document.querySelectorAll(`#app-admin .app-nav .nav-item[onclick*="'${screenId}'"]`);
                 activeLinks.forEach(link => { if(link) link.classList.add('active'); });
             } else {
                 console.error("Admin screen content not found:", screenId);
                 showScreen_Admin('screen-dashboard-urgent');
             }
         }

         // **** ADDED: Zone Interaction Functions ****
         function openAssignModal(buttonElement) {
             const card = buttonElement.closest('.urgent-card');
             if (card) {
                 jobToAssignElement = card; // Remember which card was clicked
                 const customerName = card.dataset.customerName || "ไม่ทราบชื่อ";
                 const modalCustomerName = document.getElementById('assign-customer-name');
                 if(modalCustomerName) modalCustomerName.innerText = `ลูกค้า: ${customerName}`;
                 showModal('assign-job-modal');
             } else {
                  console.error("Could not find parent card for assignment.");
             }
         }

         function confirmAssignment() {
             const selectedChecker = document.getElementById('assign-checker-select')?.value;
             if (jobToAssignElement && selectedChecker) {
                 console.log(`Assigning job for ${jobToAssignElement.dataset.customerName} to ${selectedChecker}`);
                 jobToAssignElement.remove(); // Remove the card from the list
                 jobToAssignElement = null; // Clear the stored element
                 hideModal('assign-job-modal');
                 // You might want to update the header count here too if needed
                 const queueHeader = document.querySelector('#screen-dashboard-urgent .app-header');
                 const remainingItems = document.querySelectorAll('#urgent-queue-list .urgent-card').length;
                 if (queueHeader) queueHeader.innerText = `Queue เคสด่วน (${remainingItems})`;

             } else {
                 console.error("No job element stored or checker selected.");
                 hideModal('assign-job-modal'); // Still hide modal on error or cancel
             }
         }

         function addChecker() {
             const checkerIdInput = document.getElementById('new-checker-id');
             const checkerNameInput = document.getElementById('new-checker-name');
             const tableBody = document.getElementById('team-table-body');

             if (checkerIdInput && checkerNameInput && tableBody) {
                 const checkerId = checkerIdInput.value.trim();
                 const checkerName = checkerNameInput.value.trim();

                 if (checkerId && checkerName) {
                     // Create new row
                     const newRow = document.createElement('tr');
                     newRow.innerHTML = `
                         <td>${checkerId}</td>
                         <td>${checkerName}</td>
                         <td><span class="text-skl-green font-medium">Active</span></td>
                         <td><button class="action-button" onclick="removeChecker(this)"><i class="fas fa-trash-alt"></i></button></td>
                     `;
                     tableBody.appendChild(newRow);

                     // Clear inputs and hide modal
                     checkerIdInput.value = '';
                     checkerNameInput.value = '';
                     hideModal('add-checker-modal');
                 } else {
                      console.warn("Please enter both Checker ID and Name.");
                      // Maybe show an error message in the modal
                 }
             } else {
                 console.error("Add checker modal elements not found.");
                 hideModal('add-checker-modal');
             }
         }

         function removeChecker(buttonElement) {
             const row = buttonElement.closest('tr');
             if (row) {
                 const checkerName = row.cells[1]?.innerText || 'this checker';
                 // Simple confirmation using console, replace with a modal if needed
                 console.log(`Simulating removal of ${checkerName}`);
                 row.remove();
                 // Optional: Add visual feedback like a temporary message
             } else {
                  console.error("Could not find row to remove.");
             }
         }
         // **** END ADDED ****


        // --- Initialize ---
        document.addEventListener('DOMContentLoaded', () => {
             try {
                 // Set initial screen content for Admin (will be shown by showAppView)
                 currentScreen_Admin = 'screen-dashboard-urgent';

                 // Set other personas' initial screens (but keep wrappers hidden)
                 showScreen_Customer('screen-dashboard');
                 showScreen_Checker('screen-dashboard-ck');
                 showScreen_AD('screen-dashboard-ad');

                 showAppView('app-customer'); // Show customer view first
                 generateCalendar(2025, 9);
                 disableFeedbackNav();
                 document.getElementById('persona-options').classList.add('hidden');
                 isPersonaSwitcherOpen = false;
             } catch (error) { console.error("Initialization error:", error); }
        });

    </script>
</body>
</html>

